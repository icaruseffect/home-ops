apiVersion: stackgres.io/v1
kind: SGCluster
metadata:
  name: home-assistant-db
  namespace: home
spec:
  instances: 1
  postgres:
    version: '14.2'
  pods:
    persistentVolume:
      size: 10Gi
      storageClass: longhorn
  # sgInstanceProfile: 'size-xs'
  prometheusAutobind: true
  initialData:
    scripts:
    - name: create-database
      script: |
        set AUTOCOMMIT on
        create user ${SECRET_HASS_DB_USERNAME} password '${SECRET_HASS_DB_PASSWORD}';
        create database ${SECRET_HASS_DB_NAME} owner ${SECRET_HASS_DB_USERNAME};
